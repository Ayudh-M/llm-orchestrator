
#!/bin/bash
#SBATCH --job-name=consensus
#SBATCH --time=00:20:00
#SBATCH --partition=gpu
#SBATCH --gres=gpu:1
#SBATCH --cpus-per-task=8
#SBATCH --mem=24G
#SBATCH --output=logs/%x-%j.out

set -euo pipefail

# Snellius module stack (example; adjust to your project account)
module purge
# module load 2024
# module load Python/3.11 CUDA/12.1 cuDNN/8.9

# Activate venv
if [ -d "$HOME/.venvs/consensus" ]; then
  source "$HOME/.venvs/consensus/bin/activate"
fi

export HF_HOME=${TMPDIR:-/tmp}/hf_cache
export TRANSFORMERS_OFFLINE=0

# For now, we run mock locally â€” replace with real models on cluster
python -m src.main --mock --task "2+2" --answer "4" --out runs/${SLURM_JOB_ID}.json
